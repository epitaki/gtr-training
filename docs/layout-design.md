# レイアウト設計ドキュメント

## 概要

GTRトレーニングツールの全体レイアウト設計について記載します。本サイトはSPA（Single Page Application）構成で、**ヘッダー + サイドメニュー + コンテンツエリア**の3領域で構成されます。

## 全体構造（SPA設計）

```
┌─────────────────────────────────────────────────────────┐
│ A. ヘッダー (ロゴ・アカウント) - 固定表示              │
├──────────┬──────────────────────────────────────────────┤
│          │ C. コンテンツエリア (選択モードで切り替わる) │
│          │ ┌──────────────────────────────────────────┐ │
│ B. サイド│ │                                          │ │
│  メニュー│ │  - TOPページ                             │ │
│          │ │  - 初心者用ガイド付きGTR練習             │ │
│  - TOP   │ │  - GTRスコアアタック                     │ │
│  - スコア│ │  - 対戦モード（未実装）                  │ │
│  - ガイド│ │  - 統計情報（未実装）                    │ │
│  - 対戦  │ │                                          │ │
│  - 統計  │ │  ゲーム画面の場合：                      │ │
│          │ │  ┌────────────────┐                     │ │
│  固定表示│ │  │ D. Phaserゲーム│                     │ │
│          │ │  │    エリア      │                     │ │
│          │ │  │  ┌──────────┐  │                     │ │
│          │ │  │  │ E. 外枠  │  │                     │ │
│          │ │  │  │ (灰色枠) │  │                     │ │
│          │ │  │  │┌────────┐│  │                     │ │
│          │ │  │  ││F.内枠  ││  │                     │ │
│          │ │  │  ││(黒枠)  ││  │                     │ │
│          │ │  │  ││ぷよ    ││  │                     │ │
│          │ │  │  ││フィールド││  │                     │ │
│          │ │  │  │└────────┘│  │                     │ │
│          │ │  │  └──────────┘  │                     │ │
│          │ │  └────────────────┘                     │ │
│          │ └──────────────────────────────────────────┘ │
└──────────┴──────────────────────────────────────────────┘
```

## 各エリアの詳細

### A. ヘッダーエリア
- **コンポーネント**: `Header.tsx`
- **サイズ**: 高さ64px、全幅
- **表示**: 固定表示（スクロールしても常に表示）
- **内容**:
  - 左上：サイトロゴ「GTR-training」（クリックでTOPページに戻る）
  - 右上：アカウントアイコン（クリックでドロップダウンメニュー展開）
- **スタイル**: 青紫グラデーション背景
- **実装**: Tailwind CSS でflex layout

### B. サイドメニューエリア
- **コンポーネント**: `SideMenu.tsx`
- **サイズ**: 幅256px、ヘッダー下からフル高さ
- **表示**: 固定表示（常に画面左側に表示）
- **内容**:
  - TOP
  - GTR training（スコアアタック）
  - 初心者用ガイド付きGTR練習
  - 対戦モード（未実装）
  - 統計情報（未実装）
  - ユーザー情報（将来実装）
- **スタイル**: ダークテーマ（bg-gray-900）
- **機能**: クリックでコンテンツエリアを切り替え

### C. コンテンツエリア
- **コンポーネント**: `MainLayout.tsx` の children
- **サイズ**: 残りの領域（左側256px、上部64px除く）
- **表示**: 選択したモードに応じて動的に切り替わる
- **内容**:
  - TOPページ（`TopPage.tsx`）
  - 初心者用ガイド付きゲーム（`GuidedGame.tsx`）
  - スコアアタックゲーム（`ScoreAttackGame.tsx`）
  - 対戦モード（未実装）
  - 統計情報（未実装）
- **スタイル**: 明るい背景（bg-gray-100）、パディング付き

### D. ゲームエリア（コンテンツエリア内）
- **コンポーネント**: `GuidedGame.tsx` / `ScoreAttackGame.tsx`
- **サイズ**:
  - 初心者用ガイド付き：800×800px
  - スコアアタック：600×800px
- **背景**: bg-black rounded-lg shadow-2xl
- **内容**: EとFを含むPhaserキャンバス

## Phaserゲーム内レイアウト

### 座標系とサイズ

#### 全体設定
```typescript
// GameManager.ts
width: 500px
height: 800px
```

#### E. 外枠（灰色フレーム）
- **色**: 0x444444
- **サイズ**: 444×708px
- **位置**: ゲーム画面中央
- **目的**: ぷよフィールドの外枠として視覚的境界

#### F. 内枠（ぷよフィールド）
- **色**: 0x000000（黒背景）
- **サイズ**: 324×702px（6列×13行）
- **セルサイズ**: 54×54px
- **位置**: 
  - X座標: 89px（中央配置）
  - Y座標: 90px（上部余白確保）
- **行番号**: 1-13行（13行目が最下段）

### セル配置計算

```typescript
// 中央配置の計算
FIELD_X = 89  // (500 - 6*54) / 2 = 88 ≈ 89
FIELD_Y = 90  // 適切な上部余白

// セルの実際位置
cellX = FIELD_X + (column * CELL_SIZE) + CELL_SIZE/2
cellY = FIELD_Y + (row * CELL_SIZE) + CELL_SIZE/2
```

## ぷよスプライト仕様

### サイズとテクスチャ
- **セルサイズ**: 54×54px（元の30pxから1.8倍）
- **表示サイズ**: 53×53px（セルサイズ-1px）
- **テクスチャサイズ**: 54×54px
- **色**: 赤、緑、青、黄、紫の5色

### 描画仕様
```typescript
// 外枠（立体感）
fillCircle(27, 27, 26) // 黒い外枠

// メインカラー  
fillCircle(27, 27, 24) // ぷよの色

// ハイライト（光沢効果）
fillCircle(21, 21, 7) // 白いハイライト
```

## 操作UI

### キー配置
- **移動**: ← → 矢印キー
- **高速落下**: ↓ 矢印キー
- **回転**: Z（左回転）、X（右回転）
- **リセット**: Space キー

### 表示位置
- **ゲーム内**: 画面左上に操作説明テキスト
- **サイドバー**: 操作方法セクションに詳細表示

## レスポンシブ設計

### ブレイクポイント
- **デスクトップ**: lg:grid-cols-4（サイドバー表示）
- **モバイル**: grid-cols-1（縦積み表示）

### ゲームエリア
- **固定サイズ**: 500×800px（ゲームプレイの一貫性確保）
- **中央配置**: mx-auto でセンタリング

## 今後の拡張性

### GTRガイド表示エリア
- Eの外枠内、Fの上部余白エリアを活用
- GTR形状のガイドライン表示予定

### NEXT表示エリア  
- Eの外枠内、Fの右側余白エリアを活用
- 次のぷよペア表示予定

### スコア・統計表示
- サイドバーDエリアで詳細スコア表示
- ランキング情報の表示

## 技術的詳細

### 使用技術
- **フロントエンド**: React + TypeScript
- **ゲームエンジン**: Phaser 3
- **スタイリング**: Tailwind CSS
- **状態管理**: Zustand（実装予定）

### ファイル構成
```
src/
├── components/
│   ├── layout/
│   │   ├── Header.tsx         # ヘッダー（A）
│   │   ├── SideMenu.tsx       # サイドメニュー（B）
│   │   └── MainLayout.tsx     # メインレイアウト（A+B+C統合）
│   ├── TopPage.tsx            # TOPページ（C内）
│   ├── GuidedGame.tsx         # 初心者用ガイド付きゲーム（C内、D含む）
│   ├── ScoreAttackGame.tsx    # スコアアタックゲーム（C内、D含む）
│   ├── TopMenu.tsx            # 旧TOPメニュー（非推奨）
│   ├── GameLayout.tsx         # 旧レイアウト（非使用）
│   └── GameBoard.tsx          # 旧ゲームボード（非使用）
├── game/
│   ├── GameManager.ts         # Phaserゲーム設定
│   ├── PuyoGame.ts            # スコアアタック用シーン（E,F）
│   ├── scenes/
│   │   └── GuidedPracticeScene.ts  # ガイド付き練習シーン（E,F）
│   ├── GameField.ts           # フィールド管理
│   ├── PuyoPair.ts            # ぷよペア管理
│   ├── GTRPatterns.ts         # GTR検出・評価
│   └── GuideManager.ts        # ガイド表示管理
└── App.tsx                    # SPA ルート
```

## 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2024-XX-XX | 初期レイアウト設計（400×700px） |
| 2024-XX-XX | ゲーム画面を400×800pxに拡張 |
| 2024-XX-XX | セルサイズを45pxに拡大（1.5倍） |
| 2024-XX-XX | セルサイズを54pxに拡大（1.2倍） |
| 2024-XX-XX | ゲーム画面を500×800pxに拡張（文字切れ対応） |
| 2024-11-24 | SPA構成へ全面刷新（ヘッダー+サイドメニュー+コンテンツエリア） |

## 設計原則

1. **視認性優先**: ぷよが見やすいサイズと配置
2. **操作性重視**: 直感的なキー配置と説明表示
3. **拡張性確保**: GTRガイド等の機能追加に対応
4. **レスポンシブ**: デスクトップ・モバイル対応
5. **一貫性維持**: ゲーム画面サイズは固定で体験統一